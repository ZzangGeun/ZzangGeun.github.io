---
layout: default
---
<div class="post-container">
  <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <header class="post-header">
      <h1 class="post-title p-name" itemprop="name headline">{{ page.title | escape }}</h1>
      <p class="post-meta">
        <time class="dt-published" datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">
          {%- assign date_format = site.minima.date_format | default: "%b %-d, %Y" -%}
          {{ page.date | date: date_format }}
        </time>
        {%- if page.author -%}
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{{ page.author }}</span></span>
        {%- endif -%}</p>
    </header>

    <div class="post-content e-content" itemprop="articleBody">
      {{ content }}
    </div>

    {%- if site.disqus.shortname -%}
      {%- include disqus_comments.html -%}
    {%- endif -%}

    <a class="u-url" href="{{ page.url | relative_url }}" hidden></a>
  </article>

  <aside class="toc-sidebar">
    <div class="toc-wrapper">
      <h3 class="toc-title">목차</h3>
      <nav class="toc">
        <ul id="toc-list">
          <!-- TOC will be generated by JavaScript -->
        </ul>
      </nav>
    </div>
  </aside>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tocList = document.getElementById('toc-list');
  const headings = document.querySelectorAll('.post-content h1, .post-content h2, .post-content h3, .post-content h4, .post-content h5, .post-content h6');
  
  if (headings.length === 0) {
    document.querySelector('.toc-sidebar').style.display = 'none';
    return;
  }
  
  headings.forEach((heading, index) => {
    // Add ID to heading if it doesn't have one
    if (!heading.id) {
      heading.id = 'heading-' + index;
    }
    
    // Create TOC item
    const li = document.createElement('li');
    li.className = 'toc-item toc-' + heading.tagName.toLowerCase();
    
    const a = document.createElement('a');
    a.href = '#' + heading.id;
    a.textContent = heading.textContent;
    a.className = 'toc-link';
    
    // Smooth scroll
    a.addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById(heading.id).scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    });
    
    li.appendChild(a);
    tocList.appendChild(li);
  });
  
  // Highlight current section
  function highlightCurrentSection() {
    const scrollPosition = window.scrollY + 100;
    let current = '';
    
    headings.forEach(heading => {
      const top = heading.offsetTop;
      if (scrollPosition >= top) {
        current = heading.id;
      }
    });
    
    document.querySelectorAll('.toc-link').forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === '#' + current) {
        link.classList.add('active');
      }
    });
  }
  
  window.addEventListener('scroll', highlightCurrentSection);
  highlightCurrentSection();
});

// 코드 복사 기능
document.addEventListener('DOMContentLoaded', function() {
  // 모든 pre 태그에 복사 버튼 추가
  document.querySelectorAll('.post-content pre').forEach(pre => {
    // 이미 code-block으로 감싸져 있지 않은 경우에만 처리
    if (!pre.parentElement.classList.contains('code-block')) {
      // pre 태그를 code-block div로 감싸기
      const codeBlock = document.createElement('div');
      codeBlock.className = 'code-block';
      
      // 복사 버튼 생성
      const copyButton = document.createElement('button');
      copyButton.className = 'copy-button';
      copyButton.textContent = '복사';
      
      // pre 태그를 감싸기
      pre.parentNode.insertBefore(codeBlock, pre);
      codeBlock.appendChild(copyButton);
      codeBlock.appendChild(pre);
      
      // 복사 이벤트 리스너 추가
      copyButton.addEventListener('click', () => {
        const code = pre.querySelector('code');
        const text = code ? code.innerText : pre.innerText;
        navigator.clipboard.writeText(text).then(() => {
          copyButton.textContent = '복사됨!';
          setTimeout(() => copyButton.textContent = '복사', 1500);
        }).catch(err => {
          console.error('복사 실패:', err);
          // fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = text;
          document.body.appendChild(textArea);
          textArea.focus();
          textArea.select();
          try {
            document.execCommand('copy');
            copyButton.textContent = '복사됨!';
            setTimeout(() => copyButton.textContent = '복사', 1500);
          } catch (err) {
            console.error('Fallback 복사도 실패:', err);
          }
          document.body.removeChild(textArea);
        });
      });
    }
  });
});
</script>
