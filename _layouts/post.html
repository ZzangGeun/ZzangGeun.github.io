---
layout: default
---
<div class="post-container">
  <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">    <header class="post-header">
      {%- if page.series -%}
        <div class="post-series">
          <span class="series-tag">ğŸ“š {{ page.series }}</span>
        </div>
      {%- endif -%}
      {%- if page.tag -%}
        <div class="post-tags">
          {%- assign tags = page.tag | split: ' ' -%}
          {%- for tag in tags -%}
            <span class="tag-item">#{{ tag }}</span>
          {%- endfor -%}
        </div>
      {%- endif -%}
      <h1 class="post-title p-name" itemprop="name headline">{{ page.title | escape }}</h1>
      <p class="post-meta">
        <time class="dt-published" datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">
          {%- assign date_format = site.minima.date_format | default: "%b %-d, %Y" -%}
          {{ page.date | date: date_format }}
        </time>
        {%- if page.author -%}
          â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{{ page.author }}</span></span>
        {%- endif -%}</p>
    </header>

    <div class="post-content e-content" itemprop="articleBody">
      {{ content }}
    </div>

    {%- if site.disqus.shortname -%}
      {%- include disqus_comments.html -%}
    {%- endif -%}

    <a class="u-url" href="{{ page.url | relative_url }}" hidden></a>
  </article>

  <aside class="toc-sidebar">
    <div class="toc-wrapper">
      <h3 class="toc-title">ëª©ì°¨</h3>
      <nav class="toc">
        <ul id="toc-list">
          <!-- TOC will be generated by JavaScript -->
        </ul>
      </nav>
    </div>
  </aside>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tocList = document.getElementById('toc-list');
  const headings = document.querySelectorAll('.post-content h1, .post-content h2, .post-content h3');
  
  if (headings.length === 0) {
    document.querySelector('.toc-sidebar').style.display = 'none';
    return;
  }
  
  headings.forEach((heading, index) => {
    // Add ID to heading if it doesn't have one
    if (!heading.id) {
      heading.id = 'heading-' + index;
    }
    
    // Create TOC item
    const li = document.createElement('li');
    li.className = 'toc-item toc-' + heading.tagName.toLowerCase();
    
    const a = document.createElement('a');
    a.href = '#' + heading.id;
    a.textContent = heading.textContent;
    a.className = 'toc-link';
    
    // Smooth scroll
    a.addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById(heading.id).scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    });
    
    li.appendChild(a);
    tocList.appendChild(li);
  });
  
  // Highlight current section
  function highlightCurrentSection() {
    const scrollPosition = window.scrollY + 100;
    let current = '';
    
    headings.forEach(heading => {
      const top = heading.offsetTop;
      if (scrollPosition >= top) {
        current = heading.id;
      }
    });
    
    document.querySelectorAll('.toc-link').forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === '#' + current) {
        link.classList.add('active');
      }
    });
  }
  
  window.addEventListener('scroll', highlightCurrentSection);
  highlightCurrentSection();
});

// ì½”ë“œ ë³µì‚¬ ê¸°ëŠ¥
document.addEventListener('DOMContentLoaded', function() {
  // ë¼ì¸ ë²ˆí˜¸ ìš”ì†Œë“¤ ì œê±°
  function removeLineNumbers() {
    // ë‹¤ì–‘í•œ ë¼ì¸ ë²ˆí˜¸ ìš”ì†Œë“¤ ì œê±°
    const lineNumberSelectors = [
      '.line-numbers-rows',
      '.gutter',
      '.rouge-gutter', 
      '.lineno',
      '.line-number',
      '.hljs-ln-numbers',
      '.rouge-table .rouge-gutter'
    ];
    
    lineNumberSelectors.forEach(selector => {
      document.querySelectorAll('.post-content ' + selector).forEach(element => {
        element.remove();
      });
    });
    
    // Rouge í…Œì´ë¸” êµ¬ì¡° ì •ë¦¬
    document.querySelectorAll('.post-content .rouge-table').forEach(table => {
      const codeCell = table.querySelector('.rouge-code');
      if (codeCell && table.parentNode) {
        // ì½”ë“œ ë‚´ìš©ë§Œ ì¶”ì¶œí•´ì„œ í…Œì´ë¸”ì„ ëŒ€ì²´
        const pre = codeCell.querySelector('pre');
        if (pre) {
          table.parentNode.replaceChild(pre, table);
        }
      }
    });
  }
  
  // ë¼ì¸ ë²ˆí˜¸ ì œê±° ì‹¤í–‰
  removeLineNumbers();
  
  // ëª¨ë“  ì½”ë“œ ë¸”ë¡ ì»¨í…Œì´ë„ˆ ì°¾ê¸° (highlight, highlighter-rouge, pre ë“±)
  function findCodeBlocks() {
    const codeBlocks = [];
    
    // highlight ì»¨í…Œì´ë„ˆë“¤ ì°¾ê¸°
    document.querySelectorAll('.post-content .highlight, .post-content .highlighter-rouge').forEach(highlight => {
      if (!highlight.closest('.code-block')) {
        codeBlocks.push(highlight);
      }
    });
    
    // ë…ë¦½ì ì¸ pre íƒœê·¸ë“¤ ì°¾ê¸° (highlightë¡œ ê°ì‹¸ì§€ì§€ ì•Šì€)
    document.querySelectorAll('.post-content pre').forEach(pre => {
      if (!pre.closest('.highlight') && !pre.closest('.highlighter-rouge') && !pre.closest('.code-block')) {
        codeBlocks.push(pre);
      }
    });
    
    return codeBlocks;
  }
    // ì—°ì†ëœ ì½”ë“œ ë¸”ë¡ë“¤ì„ ê·¸ë£¹í™”
  function groupConsecutiveElements(elements) {
    if (elements.length === 0) return [];
    
    const groups = [];
    let currentGroup = [elements[0]];
    
    for (let i = 1; i < elements.length; i++) {
      const current = elements[i];
      const previous = elements[i - 1];
      
      // ë‘ ìš”ì†Œ ì‚¬ì´ì˜ ê±°ë¦¬ ê³„ì‚°
      let isConsecutive = false;
      let walker = previous.nextSibling;
      
      while (walker && walker !== current) {
        // í…ìŠ¤íŠ¸ ë…¸ë“œê°€ ê³µë°±ë§Œ í¬í•¨í•˜ê±°ë‚˜, ë¹ˆ p íƒœê·¸ì¸ ê²½ìš° ì—°ì†ìœ¼ë¡œ ê°„ì£¼
        if (walker.nodeType === Node.TEXT_NODE) {
          if (walker.textContent.trim().length > 0) {
            break; // ì˜ë¯¸ìˆëŠ” í…ìŠ¤íŠ¸ê°€ ìˆìœ¼ë©´ ì—°ì†ì´ ì•„ë‹˜
          }
        } else if (walker.nodeType === Node.ELEMENT_NODE) {
          if (walker.tagName === 'P' && walker.textContent.trim().length === 0) {
            // ë¹ˆ p íƒœê·¸ëŠ” ë¬´ì‹œ
          } else if (walker.tagName === 'BR') {
            // br íƒœê·¸ëŠ” ë¬´ì‹œ
          } else {
            break; // ë‹¤ë¥¸ ì˜ë¯¸ìˆëŠ” ìš”ì†Œê°€ ìˆìœ¼ë©´ ì—°ì†ì´ ì•„ë‹˜
          }
        }
        walker = walker.nextSibling;
      }
      
      if (walker === current) {
        isConsecutive = true;
      }
      
      if (isConsecutive) {
        currentGroup.push(current);
      } else {
        groups.push([...currentGroup]);
        currentGroup = [current];
      }
    }
    
    groups.push(currentGroup);
    return groups;
  }
  
  const allCodeBlocks = findCodeBlocks();
  const codeGroups = groupConsecutiveElements(allCodeBlocks);
  
  codeGroups.forEach(group => {
    if (group.length > 0) {
      // ê·¸ë£¹ì˜ ì²« ë²ˆì§¸ ìš”ì†Œ ì•ì— code-block div ìƒì„±
      const codeBlock = document.createElement('div');
      codeBlock.className = 'code-block';
      
      // ë³µì‚¬ ë²„íŠ¼ ìƒì„±
      const copyButton = document.createElement('button');
      copyButton.className = 'copy-button';
      copyButton.textContent = 'ë³µì‚¬';
      
      // ì²« ë²ˆì§¸ ìš”ì†Œ ì•ì— code-block ì‚½ì…
      const firstElement = group[0];
      firstElement.parentNode.insertBefore(codeBlock, firstElement);
      codeBlock.appendChild(copyButton);
      
      // ëª¨ë“  ìš”ì†Œë“¤ì„ code-block ì•ˆìœ¼ë¡œ ì´ë™
      group.forEach(element => {
        codeBlock.appendChild(element);
      });
      
      // ë³µì‚¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
      copyButton.addEventListener('click', () => {
        // ê·¸ë£¹ ë‚´ ëª¨ë“  ì½”ë“œ í•©ì¹˜ê¸°
        let allText = '';
        
        group.forEach((element, index) => {
          let text = '';
          
          // highlight ë˜ëŠ” highlighter-rouge ì»¨í…Œì´ë„ˆì¸ ê²½ìš°
          if (element.classList.contains('highlight') || element.classList.contains('highlighter-rouge')) {
            const codeElement = element.querySelector('code');
            if (codeElement) {
              text = codeElement.innerText;
            } else {
              const preElement = element.querySelector('pre');
              text = preElement ? preElement.innerText : element.innerText;
            }
          } else {
            // ì¼ë°˜ pre íƒœê·¸ì¸ ê²½ìš°
            const code = element.querySelector('code');
            text = code ? code.innerText : element.innerText;
          }
          
          allText += text;
          if (index < group.length - 1) {
            allText += '\n';
          }
        });
        
        navigator.clipboard.writeText(allText).then(() => {
          copyButton.textContent = 'ë³µì‚¬ë¨!';
          setTimeout(() => copyButton.textContent = 'ë³µì‚¬', 1500);
        }).catch(err => {
          console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
          // fallback for older browsers
          const textArea = document.createElement('textarea');
          textArea.value = allText;
          document.body.appendChild(textArea);
          textArea.focus();
          textArea.select();
          try {
            document.execCommand('copy');
            copyButton.textContent = 'ë³µì‚¬ë¨!';
            setTimeout(() => copyButton.textContent = 'ë³µì‚¬', 1500);
          } catch (err) {
            console.error('Fallback ë³µì‚¬ë„ ì‹¤íŒ¨:', err);
          }
          document.body.removeChild(textArea);
        });
      });
    }
  });
});
</script>
